'use strict';
Object.defineProperty(exports, "__esModule", { value: true });
exports.altairExpress = void 0;
const express = require("express");
const altair_static_1 = require("altair-static");
exports.altairExpress = (opts) => {
    const app = express();
    app.disable('strict routing');
    app.get('/', (req, res) => {
        if (req.originalUrl.substr(-1) !== '/') {
            // We need the trailing slash to enable relative file paths to work
            return res.redirect(301, req.originalUrl + '/');
        }
        return res.send(altair_static_1.renderAltair(opts));
    });
    app.get('/initial_options.js', (req, res) => {
        res.set('Content-Type', 'text/javascript');
        return res.send(altair_static_1.renderInitialOptions(opts));
    });
    app.use(express.static(altair_static_1.getDistDirectory()));
    /**
     * Catch-all route
     */
    app.get('*', (req, res) => {
        return res.send('404.');
    });
    return app;
};
